function Get-MdVulnerability {
<#
.SYNOPSIS
    Retrieves a list of all the vulnerabilities.

.DESCRIPTION
    Retrieves a list of all the vulnerabilities.

    Scopes required (delegate auth): Vulnerability.Read

.PARAMETER Authorization
    

.PARAMETER VulnerabilityID
    ID of the vulnerability to retrieve.

.EXAMPLE
    PS C:\> Get-MdVulnerability -Authorization $authorization

    <insert description here>

.EXAMPLE
    PS C:\> Get-MdVulnerability

    Retrieves a list of all the vulnerabilities.

.EXAMPLE
    PS C:\> Get-MdVulnerability -Authorization $authorization -VulnerabilityID $vulnerabilityid

    <insert description here>

.LINK
    https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/get-all-vulnerabilities?view=o365-worldwide
#>
    [CmdletBinding(DefaultParameterSetName = 'default')]
    param (
        [Parameter(Mandatory = $true, ValueFromPipelineByPropertyName = $true, ParameterSetName = '')]
        [Parameter(Mandatory = $true, ValueFromPipelineByPropertyName = $true, ParameterSetName = 'GetVulnerability')]
        [string]
        $Authorization,

        [Parameter(Mandatory = $true, ValueFromPipeline = $true, ValueFromPipelineByPropertyName = $true, ParameterSetName = 'GetVulnerability')]
        [Alias('Id')]
        [string]
        $VulnerabilityID
    )
    process {
		$__mapping = @{
            'Authorization' = 'Authorization'
		}

		$__param = @{
			Body = $PSBoundParameters | ConvertTo-HashTable -Include @() -Mapping $__mapping
			Query = $PSBoundParameters | ConvertTo-HashTable -Include @() -Mapping $__mapping
			Header = $PSBoundParameters | ConvertTo-HashTable -Include @('Authorization') -Mapping $__mapping
			Path = 'vulnerabilities'
			Method = 'get'
			RequiredScopes = 'Vulnerability.Read'
			
		}
		if ($VulnerabilityID) { $__param.Path += "/$VulnerabilityID" }
		$__param += $PSBoundParameters | ConvertTo-HashTable -Include 'ErrorAction', 'WarningAction', 'Verbose'

		try { Invoke-DefenderAPIRequest @__param }
		catch { $PSCmdlet.ThrowTerminatingError($_) }
    }
}